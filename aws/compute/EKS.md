# Amazon EKS (Elastic Kubernetes Service)

AWS が提供するフルマネージド Kubernetes サービス。EKS ファミリーには EKS、EKS Distro、EKS Anywhere がある。

## EKS ファミリー概要

```
+------------------------------------------------------------------+
|                       EKS ファミリー                              |
|                                                                  |
|  +------------------+  +------------------+  +------------------+ |
|  |   Amazon EKS     |  |   EKS Distro     |  |  EKS Anywhere    | |
|  |                  |  |    (EKS-D)       |  |                  | |
|  |  AWS クラウド     |  |   どこでも       |  | オンプレミス     | |
|  |  マネージド       |  |   自己管理       |  | エッジ環境       | |
|  +------------------+  +------------------+  +------------------+ |
|           ↑                    ↑                    ↑            |
|           +--------------------+--------------------+            |
|                    同一の Kubernetes バージョン                   |
+------------------------------------------------------------------+
```

| 項目 | Amazon EKS | EKS Distro | EKS Anywhere |
|------|------------|------------|--------------|
| **概要** | マネージド K8s サービス | K8s ディストリビューション | オンプレデプロイツール |
| **実行場所** | AWS Cloud | どこでも | オンプレミス / エッジ |
| **コントロールプレーン** | AWS マネージド | 顧客が管理 | 顧客が管理 |
| **料金** | $0.10/時間/クラスター | 無料 | 無料 (サポートは有料) |
| **サポート** | AWS サポート | コミュニティ | オプションで AWS |
| **ユースケース** | クラウドネイティブ | カスタム構築 | ハイブリッド |

---

# Part 1: Amazon EKS

AWS クラウドで Kubernetes クラスターを実行するためのマネージドサービス。

## 基本アーキテクチャ

```
+------------------------------------------------------------------+
|                        Amazon EKS                                 |
|  +------------------------------------------------------------+  |
|  |              Control Plane (AWS マネージド)                  |  |
|  |  +------------------+  +------------------+  +------------+ |  |
|  |  | API Server       |  | etcd             |  | Controller | |  |
|  |  | (複数AZ冗長)      |  | (暗号化・バックアップ)|  | Manager   | |  |
|  |  +------------------+  +------------------+  +------------+ |  |
|  +------------------------------------------------------------+  |
|                              |                                    |
|                              v                                    |
|  +------------------------------------------------------------+  |
|  |              Data Plane (顧客管理)                          |  |
|  |  +------------------+  +------------------+  +------------+ |  |
|  |  |   EC2 Node       |  |   EC2 Node       |  | Fargate    | |  |
|  |  | +-----------+    |  | +-----------+    |  | +--------+ | |  |
|  |  | | Pod | Pod |    |  | | Pod | Pod |    |  | |  Pod   | | |  |
|  |  | +-----------+    |  | +-----------+    |  | +--------+ | |  |
|  |  +------------------+  +------------------+  +------------+ |  |
|  +------------------------------------------------------------+  |
+------------------------------------------------------------------+
```

---

## ノードタイプ

### 1. マネージドノードグループ

```
+------------------------------------------+
|        Managed Node Group                |
|  +------------------------------------+  |
|  |     Auto Scaling Group             |  |
|  |  +----------+  +----------+        |  |
|  |  | EC2 Node |  | EC2 Node |  ...   |  |
|  |  +----------+  +----------+        |  |
|  +------------------------------------+  |
|     AWS が AMI 更新・スケーリング管理     |
+------------------------------------------+
```

| 特徴 | 説明 |
|------|------|
| **自動プロビジョニング** | EC2 インスタンスの作成・終了を自動化 |
| **自動更新** | AMI のローリングアップデート |
| **スケーリング** | Cluster Autoscaler と連携 |

### 2. セルフマネージドノード

| 特徴 | 説明 |
|------|------|
| **フルコントロール** | カスタム AMI、設定が可能 |
| **手動管理** | アップグレード・スケーリングを顧客が管理 |
| **柔軟性** | GPU、Inferentia 等の特殊要件に対応 |

### 3. Fargate

```
+------------------------------------------+
|            EKS on Fargate                |
|  +-----------+  +-----------+            |
|  |   Pod     |  |   Pod     |  ...       |
|  | (独立VM)  |  | (独立VM)  |            |
|  +-----------+  +-----------+            |
|      インフラ管理不要・Pod 単位課金        |
+------------------------------------------+
```

| 特徴 | 説明 |
|------|------|
| **サーバーレス** | ノード管理不要 |
| **Pod 分離** | Pod ごとに独立した実行環境 |
| **課金** | vCPU とメモリの使用量ベース |

### ノードタイプ比較

| 項目 | マネージドノード | セルフマネージド | Fargate |
|------|----------------|-----------------|---------|
| 管理負荷 | 低 | 高 | 最低 |
| カスタマイズ | 中 | 高 | 低 |
| GPU サポート | ✅ | ✅ | ❌ |
| DaemonSet | ✅ | ✅ | ❌ |
| コスト | EC2 料金 | EC2 料金 | Pod 単位 |
| スケール速度 | 中 | 中 | やや遅い |

---

## ネットワーキング

### VPC CNI

EKS のデフォルト CNI プラグイン。Pod に VPC の IP アドレスを直接割り当て。

```
+----------------------------------------------------------+
|                         VPC                               |
|  +----------------------------------------------------+  |
|  |                    Subnet                          |  |
|  |  +------------------------------------------+      |  |
|  |  |              EC2 Node                    |      |  |
|  |  |  Primary ENI: 10.0.1.10                  |      |  |
|  |  |  +--------+  +--------+  +--------+      |      |  |
|  |  |  | Pod    |  | Pod    |  | Pod    |      |      |  |
|  |  |  |10.0.1.11| |10.0.1.12| |10.0.1.13|     |      |  |
|  |  |  +--------+  +--------+  +--------+      |      |  |
|  |  +------------------------------------------+      |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
```

| 特徴 | 説明 |
|------|------|
| **ネイティブ VPC IP** | Pod が VPC 内の IP を取得 |
| **高パフォーマンス** | オーバーレイなしで低レイテンシー |
| **セキュリティグループ** | Pod にセキュリティグループを適用可能 |

### サービスメッシュ

| オプション | 説明 |
|-----------|------|
| **AWS App Mesh** | AWS マネージドのサービスメッシュ |
| **Istio** | オープンソースのサービスメッシュ |

---

## ロードバランシング

### AWS Load Balancer Controller

```
+----------------------------------------------------------+
|                     AWS Cloud                            |
|  +--------------------+  +-------------------------+     |
|  |        ALB         |  |          NLB            |     |
|  | (Ingress リソース)  |  | (Service type:LB)      |     |
|  +--------------------+  +-------------------------+     |
|            |                       |                     |
|            v                       v                     |
|  +----------------------------------------------------+  |
|  |                   EKS Cluster                      |  |
|  |  +-------------+  +-------------+  +-------------+ |  |
|  |  | Pod (app1) |  | Pod (app2) |  | Pod (app3) | |  |
|  |  +-------------+  +-------------+  +-------------+ |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
```

| リソース | Load Balancer |
|---------|---------------|
| **Ingress** | Application Load Balancer (ALB) |
| **Service (type: LoadBalancer)** | Network Load Balancer (NLB) |

### Ingress 設定例

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: my-ingress
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
spec:
  rules:
    - http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: my-service
                port:
                  number: 80
```

---

## IAM と認証

### クラスター認証

```
+----------------------------------------------------------+
|                   認証フロー                              |
|                                                          |
|  IAM User/Role                                           |
|       |                                                  |
|       v                                                  |
|  +------------------+     +-------------------------+    |
|  | aws eks          |---->| EKS API Server          |    |
|  | get-token        |     | (IAM認証 -> K8s RBAC)   |    |
|  +------------------+     +-------------------------+    |
|                                                          |
+----------------------------------------------------------+
```

### aws-auth ConfigMap

IAM プリンシパルと Kubernetes ロールのマッピング。

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: aws-auth
  namespace: kube-system
data:
  mapRoles: |
    - rolearn: arn:aws:iam::123456789012:role/EKSNodeRole
      username: system:node:{{EC2PrivateDNSName}}
      groups:
        - system:bootstrappers
        - system:nodes
  mapUsers: |
    - userarn: arn:aws:iam::123456789012:user/admin
      username: admin
      groups:
        - system:masters
```

### IAM Roles for Service Accounts (IRSA)

Pod に AWS サービスへのアクセス権限を付与。

```
+----------------------------------------------------------+
|                        IRSA                               |
|  +----------------------------------------------------+  |
|  |                   EKS Cluster                      |  |
|  |  +--------------+                                  |  |
|  |  |     Pod      |                                  |  |
|  |  | ServiceAccount: my-sa                           |  |
|  |  +--------------+                                  |  |
|  |         |                                          |  |
|  |         | OIDC Token                               |  |
|  |         v                                          |  |
|  +----------------------------------------------------+  |
|            |                                              |
|            v                                              |
|  +----------------------------------------------------+  |
|  |              IAM Role                               |  |
|  |  Trust: EKS OIDC Provider                          |  |
|  |  Policy: S3, DynamoDB 等へのアクセス許可            |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
```

```yaml
# ServiceAccount 設定
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-sa
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::123456789012:role/MyPodRole
```

---

## ストレージ

### EBS CSI Driver

```yaml
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: ebs-sc
provisioner: ebs.csi.aws.com
parameters:
  type: gp3
  encrypted: "true"
volumeBindingMode: WaitForFirstConsumer
```

### EFS CSI Driver

複数 Pod からの同時アクセスが必要な場合。

```yaml
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: efs-sc
provisioner: efs.csi.aws.com
parameters:
  provisioningMode: efs-ap
  fileSystemId: fs-xxxxxxxxx
  directoryPerms: "700"
```

| ストレージ | アクセスモード | ユースケース |
|-----------|---------------|-------------|
| **EBS** | ReadWriteOnce | 単一 Pod のデータ永続化 |
| **EFS** | ReadWriteMany | 複数 Pod での共有ストレージ |
| **FSx for Lustre** | ReadWriteMany | HPC、ML ワークロード |

---

## オートスケーリング

### Cluster Autoscaler

ノード数の自動調整。

```
+----------------------------------------------------------+
|              Cluster Autoscaler                           |
|                                                          |
|  Pending Pods 検知                                        |
|       |                                                  |
|       v                                                  |
|  +------------------+     +------------------+            |
|  | Scale Up         |     | Scale Down       |            |
|  | ノード追加       |     | ノード削除        |            |
|  +------------------+     +------------------+            |
+----------------------------------------------------------+
```

### Karpenter

より高速で柔軟なノードプロビジョニング。

| 項目 | Cluster Autoscaler | Karpenter |
|------|-------------------|-----------|
| スケール速度 | やや遅い | 高速 |
| インスタンス選択 | 事前定義 ASG | 動的選択 |
| Spot 対応 | 限定的 | 柔軟 |
| AWS 最適化 | 汎用的 | AWS に最適化 |

### Horizontal Pod Autoscaler (HPA)

Pod レプリカ数の自動調整。

```yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: my-app-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: my-app
  minReplicas: 2
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
```

---

## ログとモニタリング

### Container Insights

```
+----------------------------------------------------------+
|                  Container Insights                       |
|  +----------------------------------------------------+  |
|  |                   EKS Cluster                      |  |
|  |  +----------------+                                |  |
|  |  | CloudWatch     |                                |  |
|  |  | Agent          | -----> CloudWatch Logs         |  |
|  |  | (DaemonSet)    | -----> CloudWatch Metrics      |  |
|  |  +----------------+                                |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
```

### Fluent Bit / Fluentd

ログ収集とルーティング。

```yaml
# Fluent Bit DaemonSet でログを CloudWatch に送信
# クラスターレベルでの設定が可能
```

---

## セキュリティ

### Pod Security Standards

| レベル | 説明 |
|-------|------|
| **Privileged** | 制限なし |
| **Baseline** | 既知の特権エスカレーションを防止 |
| **Restricted** | 最も厳格なセキュリティポリシー |

### Secrets 管理

| 方式 | 説明 |
|------|------|
| **Kubernetes Secrets** | Base64 エンコード (暗号化ではない) |
| **Secrets Manager CSI** | AWS Secrets Manager との統合 |
| **Parameter Store CSI** | SSM Parameter Store との統合 |

### ネットワークポリシー

```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: deny-all
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
```

---

## EKS Add-ons

AWS が管理するクラスターアドオン。

| Add-on | 説明 |
|--------|------|
| **CoreDNS** | クラスター内 DNS |
| **kube-proxy** | ネットワークプロキシ |
| **VPC CNI** | Pod ネットワーキング |
| **EBS CSI Driver** | EBS ボリューム管理 |
| **ADOT** | OpenTelemetry 監視 |

---

# Part 2: EKS Distro (EKS-D)

AWS が提供するオープンソースの Kubernetes ディストリビューション。

## 概要

```
+----------------------------------------------------------+
|                    EKS Distro (EKS-D)                     |
|  +----------------------------------------------------+  |
|  |        Kubernetes (EKS と同一バージョン)            |  |
|  |  (kube-apiserver, kubelet, kube-scheduler, etc.)   |  |
|  +----------------------------------------------------+  |
|  +------------+ +------------+ +------------+            |
|  |   etcd     | |  CoreDNS   | |  Metrics   |            |
|  |            | |            | |  Server    |            |
|  +------------+ +------------+ +------------+            |
|  +----------------------------------------------------+  |
|  |         CNI Plugins / CSI Drivers                  |  |
|  +----------------------------------------------------+  |
|        AWS がテスト・セキュリティパッチを提供             |
+----------------------------------------------------------+
```

## 特徴

| 特徴 | 説明 |
|------|------|
| **EKS 互換** | Amazon EKS と同じ Kubernetes バージョン・コンポーネント |
| **オープンソース** | GitHub で公開、Apache 2.0 ライセンス |
| **セキュリティパッチ** | AWS が検証・適用したパッチを含む |
| **長期サポート** | EKS と同じバージョンライフサイクル |
| **無料** | ダウンロード・利用に料金なし |

## ユースケース

| ユースケース | 説明 |
|-------------|------|
| **自己管理 K8s** | 独自インフラで EKS 互換の K8s を運用 |
| **開発/テスト環境** | ローカル環境を EKS と同じ構成に |
| **カスタムプラットフォーム** | 独自のデプロイツールと組み合わせ |
| **エアギャップ環境** | インターネット接続なしの環境で運用 |

## EKS-D と EKS Anywhere の関係

```
+----------------------------------------------------------+
|                                                          |
|   EKS Distro (EKS-D)          EKS Anywhere               |
|   +------------------+        +------------------+        |
|   |   K8s バイナリ    |  --->  |  デプロイツール   |        |
|   |   コンポーネント   |  基盤  |  クラスター管理   |        |
|   +------------------+        +------------------+        |
|         「素材」                    「完成品」             |
|                                                          |
+----------------------------------------------------------+
```

---

# Part 3: EKS Anywhere

オンプレミスやエッジ環境で EKS と同じ Kubernetes を実行。

## アーキテクチャ

```
+----------------------------------------------------------+
|                     AWS Cloud                            |
|  +----------------------------------------------------+  |
|  |              EKS Console / API                     |  |
|  |         (モニタリング、可視化、管理)                 |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
                          |
                          | EKS Connector (オプション)
                          v
+----------------------------------------------------------+
|              オンプレミス / エッジ環境                     |
|  +----------------------------------------------------+  |
|  |           EKS Anywhere Cluster                     |  |
|  |  +----------------------------------------------+  |  |
|  |  |          Kubernetes Control Plane            |  |  |
|  |  |   (API Server, etcd, Controller Manager)     |  |  |
|  |  +----------------------------------------------+  |  |
|  |  +----------------------------------------------+  |  |
|  |  |             Worker Nodes                     |  |  |
|  |  |  +--------+ +--------+ +--------+ +--------+ |  |  |
|  |  |  |  Pod   | |  Pod   | |  Pod   | |  Pod   | |  |  |
|  |  |  +--------+ +--------+ +--------+ +--------+ |  |  |
|  |  +----------------------------------------------+  |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
```

## サポートプロバイダー

```
+------------------------------------------------------------------+
|                  EKS Anywhere Providers                          |
|  +------------------+ +------------------+ +------------------+  |
|  |     VMware       | |    Bare Metal    | |   CloudStack     |  |
|  |    vSphere       | |  (Tinkerbell)    | |   (Apache)       |  |
|  +------------------+ +------------------+ +------------------+  |
|  +------------------+ +------------------+ +------------------+  |
|  |      Nutanix     | |      Snow        | |     Docker       |  |
|  |                  | |   (AWS Snow)     | |   (開発/テスト)   |  |
|  +------------------+ +------------------+ +------------------+  |
+------------------------------------------------------------------+
```

| プロバイダー | 説明 | 本番環境 |
|-------------|------|---------|
| **VMware vSphere** | 最も一般的な仮想化環境 | ✅ |
| **Bare Metal (Tinkerbell)** | 物理サーバーへの直接デプロイ | ✅ |
| **Apache CloudStack** | オープンソースクラウドプラットフォーム | ✅ |
| **Nutanix** | ハイパーコンバージドインフラ | ✅ |
| **AWS Snow** | エッジ/切断環境向けデバイス | ✅ |
| **Docker** | ローカル開発・テスト用 | ❌ |

## クラスター構成

### Management Cluster と Workload Cluster

```
+----------------------------------------------------------+
|                   Management Cluster                      |
|  +----------------------------------------------------+  |
|  |              CAPI Controllers                       |  |
|  |  (Cluster API, Bootstrap, Infrastructure Provider) |  |
|  +----------------------------------------------------+  |
|            |                    |                         |
|            v                    v                         |
|  +------------------+  +------------------+               |
|  | Workload Cluster |  | Workload Cluster |               |
|  |    (Production)  |  |   (Staging)      |               |
|  +------------------+  +------------------+               |
+----------------------------------------------------------+
```

| クラスタータイプ | 説明 |
|-----------------|------|
| **Management Cluster** | ワークロードクラスターのライフサイクルを管理 |
| **Workload Cluster** | 実際のアプリケーションを実行 |

## クラスター作成

```bash
# 1. クラスター設定ファイル生成
eksctl anywhere generate clusterconfig my-cluster \
  --provider vsphere > cluster.yaml

# 2. クラスター作成
eksctl anywhere create cluster -f cluster.yaml

# 3. kubeconfig 取得
export KUBECONFIG=${PWD}/my-cluster/my-cluster-eks-a-cluster.kubeconfig

# 4. クラスター確認
kubectl get nodes
```

## EKS Connector

オンプレミスクラスターを AWS コンソールで可視化。

```
+----------------------------------------------------------+
|                     AWS Cloud                            |
|  +----------------------------------------------------+  |
|  |              Amazon EKS Console                    |  |
|  |    +----------+ +----------+ +----------+          |  |
|  |    | EKS      | | EKS      | | EKS      |          |  |
|  |    | Cluster  | | Anywhere | | Anywhere |          |  |
|  |    | (AWS)    | | Cluster1 | | Cluster2 |          |  |
|  |    +----------+ +----------+ +----------+          |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
         |                 ↑            ↑
         |                 |            |
         v           EKS Connector (outbound HTTPS)
    AWS管理          +----------+  +----------+
                     |  EKS-A   |  |  EKS-A   |
                     | Cluster1 |  | Cluster2 |
                     +----------+  +----------+
                        オンプレミス環境
```

| 機能 | 説明 |
|------|------|
| **可視化** | AWS コンソールでクラスターリソースを表示 |
| **統合管理** | EKS と EKS Anywhere を単一画面で管理 |
| **制限** | 読み取り専用、アウトバウンド HTTPS 必須 |

## Curated Packages

AWS が管理・検証するアドオンパッケージ群。

| パッケージ | 説明 |
|-----------|------|
| **Harbor** | コンテナレジストリ |
| **MetalLB** | ベアメタル用ロードバランサー |
| **Emissary Ingress** | API ゲートウェイ / Ingress Controller |
| **ADOT** | AWS Distro for OpenTelemetry (監視) |
| **Prometheus** | メトリクス収集 |

## AWS サービスとの統合

### IAM Roles Anywhere

EKS Anywhere では IRSA の代わりに使用。

```
+----------------------------------------------------------+
|                EKS Anywhere 環境                          |
|  +----------------------------------------------------+  |
|  |  ECR Image Pull   ←→  AWS ECR                      |  |
|  |  CloudWatch Logs  ←→  AWS CloudWatch               |  |
|  |  Secrets          ←→  AWS Secrets Manager          |  |
|  |  認証             ←→  IAM Roles Anywhere           |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+
```

## ライセンスとサポート

| 項目 | 料金 |
|------|------|
| **EKS Anywhere (OSS)** | 無料 |
| **EKS Anywhere Subscription** | 有料 (24x7 サポート) |
| **Curated Packages** | Subscription に含まれる |

---

# Part 4: EKS ユースケース選択

## ユースケース別選択ガイド

```
+------------------------------------------------------------------+
|                   どこで実行したいか？                            |
|                                                                  |
|    AWS Cloud          オンプレミス/エッジ        どこでも          |
|        |                     |                    |              |
|        v                     v                    v              |
|  +----------+         +-------------+       +----------+         |
|  | Amazon   |         | EKS         |       | EKS      |         |
|  | EKS      |         | Anywhere    |       | Distro   |         |
|  +----------+         +-------------+       +----------+         |
|        |                     |                    |              |
|  マネージド             自己管理            完全カスタム          |
+------------------------------------------------------------------+
```

| 要件 | 推奨サービス |
|------|-------------|
| フルマネージドで運用負荷を最小化 | **Amazon EKS** |
| サーバーレスでコンテナ実行 | **EKS on Fargate** |
| オンプレミスで K8s を AWS と同じ方法で運用 | **EKS Anywhere** |
| データを国外に出せない規制がある | **EKS Anywhere** |
| 切断環境でコンテナ実行 | **EKS Anywhere on Snow** |
| 独自の K8s プラットフォームを構築 | **EKS Distro** |
| ローカル開発環境を EKS と同じに | **EKS Distro** |

---

# Part 5: ECS vs EKS 比較

| 項目 | ECS | EKS |
|------|-----|-----|
| オーケストレーター | AWS 独自 | Kubernetes |
| 学習コスト | 低い | 高い |
| ポータビリティ | AWS 依存 | マルチクラウド可能 |
| 料金 | 無料 (インフラのみ) | $0.10/時間/クラスター |
| エコシステム | AWS 統合が強い | K8s エコシステム活用 |
| Anywhere | ECS Anywhere | EKS Anywhere |

## Anywhere 比較

| 項目 | ECS Anywhere | EKS Anywhere |
|------|-------------|--------------|
| オーケストレーター | ECS (AWS独自) | Kubernetes |
| コントロールプレーン | AWS (クラウド) | オンプレミス (自己管理) |
| 接続要件 | 常時 AWS 接続必須 | 切断環境で動作可能 |
| エージェント | ECS Agent + SSM Agent | eksctl anywhere + CAPI |
| ユースケース | シンプルなハイブリッド | 完全なK8s環境をオンプレに |

---

# SAA 試験のポイント

## 頻出トピック

### 1. EKS 基本

| トピック | 重要ポイント |
|---------|-------------|
| **ノードタイプ** | マネージド vs セルフマネージド vs Fargate |
| **IRSA** | Pod に AWS サービスへのアクセス権限を付与 |
| **VPC CNI** | Pod に VPC の IP を直接割り当て |
| **aws-auth** | IAM と K8s RBAC のマッピング |

### 2. EKS Distro

| トピック | 重要ポイント |
|---------|-------------|
| **定義** | EKS と同じ K8s ディストリビューション |
| **料金** | 無料、オープンソース |
| **関係** | EKS Anywhere の基盤 |

### 3. EKS Anywhere

| トピック | 重要ポイント |
|---------|-------------|
| **実行場所** | オンプレミス / エッジ |
| **コントロールプレーン** | 自己管理 (AWS ではない) |
| **EKS Connector** | AWS コンソールで可視化 (読み取り専用) |
| **プロバイダー** | vSphere, Bare Metal, Nutanix, Snow 等 |

### 4. ユースケース選択

| シナリオ | 解答 |
|---------|------|
| フルマネージド K8s が欲しい | Amazon EKS |
| サーバーレスで K8s | EKS on Fargate |
| オンプレミスで AWS と同じ K8s | EKS Anywhere |
| データを国外に出せない | EKS Anywhere |
| 切断環境で K8s | EKS Anywhere on Snow |
| EKS と同じ K8s を自分で管理 | EKS Distro |
| オンプレ K8s を AWS コンソールで見たい | EKS Connector |
| Pod から S3 にアクセス | IRSA (IAM Roles for Service Accounts) |
| IAM ユーザーに K8s 権限付与 | aws-auth ConfigMap |
| GPU ワークロード | EKS on EC2 (Fargate は非対応) |
| 複数 Pod でファイル共有 | EFS CSI Driver |

---

## 関連サービス

| サービス | 関係性 |
|---------|-------|
| **Amazon ECR** | コンテナイメージレジストリ |
| **AWS App Mesh** | サービスメッシュ |
| **AWS Fargate** | サーバーレスコンピュート |
| **IAM Roles Anywhere** | オンプレミス向け IAM |
| **AWS Outposts** | AWS インフラをオンプレミスに |
| **AWS Snow Family** | エッジ/切断環境向けデバイス |
