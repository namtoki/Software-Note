# Amazon EFS (Elastic File System)

```
┌─────────────────────────────────────────────────────────┐
│                      Amazon EFS                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │              File System (NFS)                  │   │
│  └─────────────────────────────────────────────────┘   │
│         ↑              ↑              ↑                 │
│    ┌────┴────┐    ┌────┴────┐    ┌────┴────┐           │
│    │   EC2   │    │   EC2   │    │  Lambda │           │
│    │  (AZ-a) │    │  (AZ-b) │    │  (AZ-c) │           │
│    └─────────┘    └─────────┘    └─────────┘           │
└─────────────────────────────────────────────────────────┘
```

## Overview
- マネージド NFS:                 Linux 向け共有ファイルストレージ / ==NFS v4.1== / ==複数 AZ・複数 EC2== 同時アクセス / ==!GB/月 (使用した分だけ)==
  - 自動スケーリング:             容量は ==自動で拡張/縮小== (事前プロビジョニング不要)
  - 高可用性:                     ==複数 AZ== にデータを自動レプリケート
  - 対応サービス:                 EC2, ECS, EKS, Fargate, Lambda
  - `Storage Classes`:
    | クラス | 可用性 | ユースケース |
    |-------|-------|-------------|
    | `Standard` | Multi-AZ | 頻繁にアクセス |
    | `Standard-IA` | Multi-AZ | 低頻度アクセス (コスト削減) |
    | `One Zone` | Single AZ | 開発/バックアップ (コスト最安) |
    | `One Zone-IA` | Single AZ | 低頻度 + 単一AZ |

    - `Lifecycle Management`:       アクセス頻度に応じて ==自動で IA クラスに移行== (例: 30日アクセスなし → IA)
  - `Performance Mode`:
    | モード | 特徴 | ユースケース |
    |-------|------|-------------|
    | `General Purpose` | ==低レイテンシー== (デフォルト) | Web、CMS、開発環境 |
    | `Max I/O` | ==高スループット==、高レイテンシー | ビッグデータ、メディア処理 |

  - `Throughput Mode`:
    | モード | 特徴 |
    |-------|------|
    | `Bursting` | 容量に比例 (デフォルト) |
    | `Provisioned` | ==固定スループット== を指定 |
    | `Elastic` | ==ワークロードに自動スケール== (推奨) |

  - Security:
    - `Security Groups`:            EFS マウントターゲットへのアクセス制御
    - `IAM`:                        ファイルシステムへのアクセス制御
    - `Encryption`:
      - 保存時:                   ==KMS== で暗号化
      - 転送時:                   ==TLS== で暗号化
